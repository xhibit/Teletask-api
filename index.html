<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Teletask-api by xhibit</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Teletask-api</h1>
        <p>An open source java REST API for Teletask domotics.</p>

        <p class="view"><a href="https://github.com/xhibit/Teletask-api">View the Project on GitHub <small>xhibit/Teletask-api</small></a></p>


        <ul>
          <li><a href="https://github.com/xhibit/Teletask-api/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/xhibit/Teletask-api/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/xhibit/Teletask-api">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="teletask-api" class="anchor" href="#teletask-api" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Teletask-api</h1>

<p>An open source java JSON REST API for Teletask domotics.</p>

<p>It is the purpose to generate a REST API for software developers or domotics enthusiasts, who are interested in generating their own control environment for the TELETASK domotics systems, so you can create your own user interface and connected solutions and services.</p>

<p>If you own a Teletask MICROS (note: not the latest MICROS+), you have access to the free DLL32 LIBRARY (TDS15132).  However, if you're a java programmer like myself, you don't want to use a windows dll :-)
The API also supports the MICROS+, but you'll have to buy a licence to be able to make TCP calls.
Bought me a RS232 &gt; LAN converter (TDS10118) so I could access my MICROS server through regular IP.</p>

<p>Started discussing the possibilities on the Teletask forum: <a href="http://www.teletask.be/forum/default.aspx?g=posts&amp;t=195">http://www.teletask.be/forum/default.aspx?g=posts&amp;t=195</a>
...and ended up programming a java interface based on IP Sockets, exposed by a basic JSON REST service.</p>

<p>Initially only setting and getting RELAYS, MTRUPDOWN, GENMOOD, LOCMOOD, COND, FLAG is supported.</p>

<p>Added a basic HTML 5 GUI for access on a mobile device.  Fastest implementation proved to be jQuery Mobile (at the time of creation).<br>
However I highly recommend using <strong>Home Assistant</strong>: <a href="https://home-assistant.io">https://home-assistant.io</a>
Currently the API uses an internal MQTT broker, but support for an external broker will be added to bridge with Home Assistant.
You can however already use the REST interface to make calls from Home Assistant to the TeleTask server.</p>

<h3>
<a id="how-this-api-works" class="anchor" href="#how-this-api-works" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How this API works:</h3>

<ul>
<li>Build the war file using maven (<code>mvn clean package</code>).</li>
<li>Your Teletask config is read from the tds-config.json file.  This file holds all info on your personal setup. An example config can be downloaded from <a href="https://github.com/xhibit/Teletask-api/blob/master/backend/config-json/src/main/resources/tds-config.json">here</a>.  Create one which corresponds to your setup, and store it accessible to the app server.</li>
<li>Deploy the war to a java app server on a device on your local network, so it has access to your MICROS server.  I used a low power <a href="http://www.raspberrypi.org">Raspberry PI</a>
</li>
<li>Add these VM parameters to your java app server:</li>
</ul>

<div class="highlight highlight-source-java"><pre><span class="pl-c1">JAVA_OPTS</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>$JAVA_OPTS -DconfigFile=/home/pi/teletask/tds-config.json<span class="pl-pds">"</span></span>
<span class="pl-c1">JAVA_OPTS</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>$JAVA_OPTS -Dlogfile=/home/pi/teletask/teletask.log<span class="pl-pds">"</span></span></pre></div>

<h4>
<a id="libraries--technologies" class="anchor" href="#libraries--technologies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Libraries / Technologies</h4>

<ul>
<li>Maven 3</li>
<li>JBoss RESTEasy</li>
<li>Jackson JSON processor</li>
<li>jQuery Mobile</li>
<li>...</li>
</ul>

<h3>
<a id="rest-api" class="anchor" href="#rest-api" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>REST API</h3>

<p>Base URL API
<code>http://&lt;host&gt;:&lt;port&gt;/teletask/api</code></p>

<p><strong>Config</strong></p>

<ul>
<li>URI: GET <code>&lt;base_url&gt;/component/config</code>

<ul>
<li>Description: Gets the complete configuration in JSON.</li>
</ul>
</li>
</ul>

<p><strong>Relay</strong></p>

<ul>
<li>URI: GET <code>&lt;base_url&gt;/component/state/relay/{number}</code>

<ul>
<li>Description: Gets the relay state.  Returns 0 for off, 1 for on.</li>
</ul>
</li>
<li>URI: PUT <code>&lt;base_url&gt;/component/relay/{number}/state/{on/off}</code>

<ul>
<li>Description: Switches the relay on/off.<br>
</li>
</ul>
</li>
</ul>

<p><strong>Local Mood</strong></p>

<ul>
<li>URI: GET <code>&lt;base_url&gt;/component/state/mood/local/{number}</code>

<ul>
<li>Description: Gets the mood state.  Returns 0 for off, 1 for on.</li>
</ul>
</li>
<li>URI: PUT <code>&lt;base_url&gt;/mood/local/{number}/state/{on/off}</code>

<ul>
<li>Description: Switches the mood on/off.<br>
</li>
</ul>
</li>
</ul>

<p><strong>General Mood</strong></p>

<ul>
<li>URI: GET <code>&lt;base_url&gt;/component/state/mood/general/{number}</code>

<ul>
<li>Description: Gets the mood state.  Returns 0 for off, 1 for on.</li>
</ul>
</li>
<li>URI: PUT <code>&lt;base_url&gt;/mood/general/{number}/state/{on/off}</code>

<ul>
<li>Description: Switches the mood on/off.<br>
</li>
</ul>
</li>
</ul>

<p><strong>Motor</strong></p>

<ul>
<li>URI: GET <code>&lt;base_url&gt;/component/state/motor/{number}</code>

<ul>
<li>Description: Gets the motor state.  1 for down, 0 for up.</li>
</ul>
</li>
<li>URI: PUT <code>&lt;base_url&gt;/motor/{number}/state/{down/up}</code>

<ul>
<li>Description: Switches the motor up or down. 
### Roadmap:</li>
</ul>
</li>
</ul>

<p>Current status: fully working REST API &amp; UI.</p>

<p>Future release:</p>

<ul>
<li><del>Support all micros features (dimming, check flags, conditions...)</del></li>
<li><del>Add iBeacon support: this way I can use presence detection and switch relays depending on being close to a beacon.</del></li>
<li><del>Add support for an <a href="http://www.globalcache.com/products/itachflex/">iTach Flex</a> device so I can control additional devices through IR (airco units, projector, tv, ...).</del></li>
<li><del>A more advanced HTML 5 GUI for access on a mobile device (possibly using Twitter Bootstrap, Sencha Touch, ...).</del></li>
</ul>

<p>All of these features, and a lot lot lot more are available on <a href="https://home-assistant.io">Home Assistant</a>, so only concentrating on core Teletask features, and better integration with IoT, improving MQTT support.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/xhibit">xhibit</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-76955439-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
